<!DOCTYPE html> 
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GeoGuard Pro - –ì–ª–æ–±–∞–ª—å–Ω–∏–π –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥</title>
  <!-- –ü—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö –±—ñ–±–ª—ñ–æ—Ç–µ–∫ -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/aos@2.3.4/dist/aos.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
  <script src="https://api.ipify.org?format=jsonp&callback=getIP"></script>
  <style>
    :root {
      --primary-color: #2563eb;
      --primary-dark: #1e40af;
      --warning-color: #eab308;
      --danger-color: #dc2626;
      --success-color: #16a34a;
      --bg-color-light: #f8fafc;
      --card-bg-light: #ffffff;
      --text-light: #1e293b;
      --bg-color-dark: #1e293b;
      --card-bg-dark: #374151;
      --text-dark: #f8fafc;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --border-radius: 1rem;
    }
    
    /* –ü–æ—á–∞—Ç–∫–æ–≤—ñ —Å—Ç–∏–ª—ñ (—Å–≤—ñ—Ç–ª–∞ —Ç–µ–º–∞ –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º) */
    body {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Inter', system-ui, sans-serif;
      background-color: var(--bg-color-light);
      color: var(--text-light);
      line-height: 1.6;
      transition: var(--transition);
      overflow-x: hidden;
    }
    
    /* –¢–µ–º–Ω–∞ —Ç–µ–º–∞ */
    body.dark {
      background-color: var(--bg-color-dark);
      color: var(--text-dark);
    }
    
    a {
      text-decoration: none;
      color: inherit;
    }
    
    .container {
      max-width: 1440px;
      margin: 0 auto;
      padding: 20px;
    }
    
    /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
    header.header {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: white;
      padding: 2rem 0;
      margin-bottom: 2rem;
      position: relative;
      overflow: hidden;
      box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1);
    }
    
    header.header::after {
      content: '';
      position: absolute;
      bottom: -50px;
      left: 0;
      width: 100%;
      height: 100px;
      background: var(--bg-color-light);
      transform: skewY(-3deg);
      z-index: 0;
      transition: var(--transition);
    }
    
    body.dark header.header::after {
      background: var(--bg-color-dark);
    }
    
    .header-content {
      position: relative;
      z-index: 1;
    }
    
    .header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .logo-icon {
      font-size: 1.8rem;
      color: rgba(255, 255, 255, 0.9);
    }
    
    .tagline {
      color: rgba(255, 255, 255, 0.85);
      margin-top: 0.5rem;
      font-size: 1.1rem;
    }
    
    .last-updated {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: rgba(255, 255, 255, 0.8);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    /* –°–µ–∫—Ü—ñ—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó */
    .auth-section {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 1rem;
      z-index: 100;
    }
    
    .auth-btn {
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(5px);
      padding: 0.75rem 1.5rem;
      border-radius: 50px;
      transition: var(--transition);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .auth-btn:hover {
      background: rgba(255, 255, 255, 0.2);
    }
    
    /* –§—ñ–ª—å—Ç—Ä–∏ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ */
    .disaster-filters {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
      gap: 1rem;
      margin-bottom: 2rem;
    }
    
    .filter-card {
      padding: 1.25rem;
      border-radius: var(--border-radius);
      background: var(--card-bg-light);
      cursor: pointer;
      transition: transform 0.3s, box-shadow 0.3s, background-color 0.3s;
      border: 2px solid #e2e8f0;
      display: flex;
      align-items: center;
      position: relative;
      font-weight: 600;
    }
    
    body.dark .filter-card {
      background: var(--card-bg-dark);
      border-color: #4b5563;
    }
    
    .filter-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
    }
    
    .filter-card:focus {
      outline: 2px dashed var(--primary-color);
      outline-offset: 4px;
    }
    
    .filter-card span {
      margin-left: 10px;
    }
    
    .filter-card.active {
      border-color: var(--primary-color);
      background: rgba(37, 99, 235, 0.05);
    }
    
    .filter-card.active::after {
      content: '‚úì';
      position: absolute;
      top: -10px;
      right: -10px;
      background: var(--primary-color);
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
    }
    
    .filter-icon {
      width: 50px;
      height: 50px;
      border-radius: 0.75rem;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2rem;
    }
    
    /* –°—Ç–∏–ª—ñ –¥–ª—è –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ */
    .earthquake { background: rgba(239, 68, 68, 0.1); color: #dc2626; }
    .flood { background: rgba(59, 130, 246, 0.1); color: #2563eb; }
    .volcano { background: rgba(245, 158, 11, 0.1); color: #eab308; }
    .wildfire { background: rgba(249, 115, 22, 0.1); color: #f97316; }
    
    /* –ü–µ—Ä—ñ–æ–¥ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è */
    .period-filter {
      background-color: var(--card-bg-light);
      border-radius: var(--border-radius);
      padding: 1.5rem;
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05);
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }
    
    body.dark .period-filter {
      background-color: var(--card-bg-dark);
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.3);
    }
    
    .period-filter h3 {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      font-weight: 600;
    }
    
    .period-filter h3 i {
      color: var(--primary-color);
      font-size: 1.25rem;
    }
    
    .period-selector {
      appearance: none;
      background-color: var(--bg-color-light);
      border: 2px solid var(--primary-color);
      color: var(--text-light);
      padding: 0.75rem 1.5rem;
      border-radius: 0.75rem;
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition);
      position: relative;
    }
    
    body.dark .period-selector {
      background-color: var(--bg-color-dark);
      color: var(--text-dark);
    }
    
    .period-selector:hover {
      border-color: var(--primary-dark);
      background-color: rgba(37, 99, 235, 0.05);
    }
    
    .period-selector::after {
      content: '‚ñº';
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--primary-color);
      pointer-events: none;
    }
    
    /* –ö–Ω–æ–ø–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è */
    #refresh-button {
      padding: 0.4rem 0.8rem;
      background-color: #4CAF50;
      color: white;
      font-size: 0.8rem;
      border: none;
      border-radius: 20px;
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
      transition: transform 0.2s, background-color 0.3s, box-shadow 0.3s;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }
    
    #refresh-button:hover {
      background-color: #45a049;
      transform: translateY(-3px);
      box-shadow: 0 5px 10px rgba(0, 0, 0, 0.2);
    }
    
    #refresh-button:active {
      transform: translateY(1px);
      box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
    }
    
    /* –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ */
    .disaster-indicators {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .indicator-card {
      padding: 1.5rem;
      border-radius: var(--border-radius);
      background: var(--card-bg-light);
      position: relative;
      overflow: hidden;
      transition: transform 0.3s, box-shadow 0.3s;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
    }
    
    body.dark .indicator-card {
      background: var(--card-bg-dark);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    
    .indicator-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 12px 24px rgba(0,0,0,0.2);
    }
    
    .indicator-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: var(--primary-color);
      transform: scaleX(0);
      transition: transform 0.3s ease;
    }
    
    .indicator-card.critical::before {
      background: var(--danger-color);
      transform: scaleX(1);
    }
    
    .indicator-header {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    
    .indicator-icon {
      width: 50px;
      height: 50px;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.5rem;
    }
    
    /* –ú–∞–ø–∞ */
    .map-container {
      height: 400px;
      border-radius: var(--border-radius);
      overflow: hidden;
      margin: 2rem 0;
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05);
    }
    
    /* –ê–Ω—ñ–º–∞—Ü—ñ—è –ø—É–ª—å—Å–∞—Ü—ñ—ó –¥–ª—è —Å–ø–æ–≤—ñ—â–µ–Ω—å */
    .alert-pulse {
      animation: pulse 1.5s infinite;
    }
    
    @keyframes pulse {
      0% { transform: scale(1); opacity: 1; }
      50% { transform: scale(1.05); opacity: 0.7; }
      100% { transform: scale(1); opacity: 1; }
    }
    
    /* –°—Ç—Ä—ñ—á–∫–∞ –ø–æ–¥—ñ–π */
    .disaster-timeline {
      display: flex;
      gap: 1rem;
      overflow-x: auto;
      padding: 1rem 0;
    }
    
    .timeline-event {
      min-width: 200px;
      padding: 1rem;
      border-radius: 0.75rem;
      background: var(--card-bg-light);
      position: relative;
      box-shadow: 0 4px 8px rgba(0,0,0,0.05);
      transition: transform 0.3s, box-shadow 0.3s;
    }
    
    body.dark .timeline-event {
      background: var(--card-bg-dark);
      box-shadow: 0 4px 8px rgba(0,0,0,0.3);
    }
    
    .timeline-event:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.2);
    }
    
    .notification-badge {
      position: absolute;
      top: -10px;
      right: -10px;
      background: var(--danger-color);
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
    }
    
    /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
    .stats-section {
      margin: 2rem 0;
      background: var(--card-bg-light);
      border-radius: var(--border-radius);
      padding: 2rem;
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05);
    }
    
    body.dark .stats-section {
      background: var(--card-bg-dark);
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.3);
    }
    
    .stats-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }
    
    .stats-chart-container {
      height: 400px;
      position: relative;
    }
    
    /* –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è */
    .additional-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin: 2rem 0;
    }
    
    .ip-geolocation {
      background: var(--card-bg-light);
      padding: 1.5rem;
      border-radius: var(--border-radius);
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.05);
    }
    
    body.dark .ip-geolocation {
      background: var(--card-bg-dark);
      box-shadow: 0 10px 15px -3px rgba(0,0,0,0.3);
    }
    
    .ip-geolocation h2 {
      margin-bottom: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    #network-info p {
      margin: 0.5rem 0;
      padding: 0.5rem;
      background: rgba(37, 99, 235, 0.05);
      border-radius: 0.5rem;
    }
    
    /* –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è */
    #update-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, #6e7dff, #5363f7);
      color: white;
      padding: 1rem 2rem;
      border-radius: var(--border-radius);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      display: none;
      align-items: center;
      gap: 0.5rem;
      z-index: 1000;
      animation: slideIn 0.5s ease-out;
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateX(100%); }
      to { opacity: 1; transform: translateX(0); }
    }
    
    /* –ü–µ—Ä–µ–º–∏–∫–∞—á—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å —ñ —Ç–µ–º–∏ */
    .settings-toggle, .theme-toggle {
      position: fixed;
      bottom: 20px;
      background-color: var(--primary-color);
      color: white;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 10px 20px rgba(0,0,0,0.2);
      cursor: pointer;
      transition: var(--transition);
      z-index: 1000;
    }
    
    .settings-toggle { right: 20px; }
    .theme-toggle { right: 100px; }
    
    .settings-toggle:hover, .theme-toggle:hover {
      transform: scale(1.1) rotate(90deg);
      background-color: var(--primary-dark);
    }
    
    .settings-toggle i, .theme-toggle i {
      font-size: 24px;
    }
    
    /* –¥–∏–∑–∞–π–Ω –¥–ª—è —Å–µ–∫—Ü—ñ—ó –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å */
    #settings-section {
      display: none;
      position: fixed;
      bottom: 100px;
      right: 20px;
      width: 320px;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(10px);
      border-radius: var(--border-radius);
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      padding: 1.5rem;
      z-index: 1000;
      animation: slideUp 0.3s ease;
      border: 1px solid rgba(0,0,0,0.1);
    }
    
    body.dark #settings-section {
      background: rgba(55, 65, 81, 0.9);
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      border: 1px solid rgba(255,255,255,0.1);
    }
    
    @keyframes slideUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    #settings-section h2 {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 1rem;
      font-size: 1.5rem;
    }
    
    .settings-section .form-group {
      margin-bottom: 1.5rem;
    }
    
    .settings-section label {
      display: block;
      margin-bottom: 0.5rem;
      font-weight: 500;
    }
    
    .settings-section input,
    .settings-section select {
      width: 100%;
      padding: 0.875rem 1rem;
      border: 2px solid #e2e8f0;
      border-radius: 0.75rem;
      font-size: 1rem;
      transition: var(--transition);
      background: transparent;
      color: inherit;
    }
    
    body.dark .settings-section input,
    body.dark .settings-section select {
      border-color: #4b5563;
    }
    
    .settings-section input:focus,
    .settings-section select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
    }
    
    .settings-section button {
      background: var(--primary-color);
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: 0.75rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      width: 100%;
    }
    
    .settings-section button:hover {
      background: var(--primary-dark);
      transform: translateY(-1px);
    }
    
    /* –ê–ûS –∞–Ω—ñ–º–∞—Ü—ñ—ó */
    [data-aos] {
      opacity: 0;
      transition-property: opacity, transform;
    }
    
    [data-aos].aos-animate {
      opacity: 1;
      transform: translate(0);
    }
    
    /* –ú–µ–¥—ñ–∞-–∑–∞–ø–∏—Ç–∏ */
    @media (max-width: 768px) {
      .container { padding: 1rem; }
      .header h1 { font-size: 2rem; }
      .theme-toggle { right: 80px; }
      #settings-section { width: 90%; right: 5%; }
    }
  </style>
</head>
<body>
  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <header class="header" data-aos="fade-down">
    <div class="container">
      <div class="auth-section">
        <a href="Login.html" class="auth-btn" aria-label="–í–∏–π—Ç–∏">
          <i class="fas fa-sign-in-alt" aria-hidden="true"></i> –í–∏–π—Ç–∏
        </a>
      </div>
      <div class="header-content">
        <h1>
          <i class="fas fa-shield-alt logo-icon" aria-hidden="true"></i>
          GeoGuard Pro
        </h1>
        <p class="tagline">–ì–ª–æ–±–∞–ª—å–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥—É –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ</p>
        <div class="last-updated" id="last-updated">
          <i class="fas fa-sync-alt" aria-hidden="true"></i>
          <span>–û–Ω–æ–≤–ª–µ–Ω–æ: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
        </div>
      </div>
    </div>
  </header>
  
  <main class="container">
     <!-- –§—ñ–ª—å—Ç—Ä–∏ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ -->
    <section class="disaster-filters-section" data-aos="fade-up">
      <h2>
        <i class="fas fa-filter" aria-hidden="true"></i> –§—ñ–ª—å—Ç—Ä –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ
      </h2>
      <div class="disaster-filters">
        <div class="filter-card active" data-type="earthquake" tabindex="0" aria-label="–§—ñ–ª—å—Ç—Ä: –ó–µ–º–ª–µ—Ç—Ä—É—Å–∏">
          <div class="filter-icon earthquake">
            <i class="fas fa-mountain" aria-hidden="true"></i>
          </div>
          <span>–ó–µ–º–ª–µ—Ç—Ä—É—Å–∏</span>
        </div>
        <div class="filter-card active" data-type="flood" tabindex="0" aria-label="–§—ñ–ª—å—Ç—Ä: –ü–æ–≤–µ–Ω—ñ">
          <div class="filter-icon flood">
            <i class="fas fa-water" aria-hidden="true"></i>
          </div>
          <span>–ü–æ–≤–µ–Ω—ñ</span>
        </div>
        <div class="filter-card active" data-type="volcano" tabindex="0" aria-label="–§—ñ–ª—å—Ç—Ä: –í—É–ª–∫–∞–Ω–∏">
          <div class="filter-icon volcano">
            <i class="fas fa-meteor" aria-hidden="true"></i>
          </div>
          <span>–í—É–ª–∫–∞–Ω–∏</span>
        </div>
        <div class="filter-card active" data-type="wildfire" tabindex="0" aria-label="–§—ñ–ª—å—Ç—Ä: –ü–æ–∂–µ–∂—ñ">
          <div class="filter-icon wildfire">
            <i class="fas fa-fire" aria-hidden="true"></i>
          </div>
          <span>–ü–æ–∂–µ–∂—ñ</span>
        </div>
      </div>
    </section>
    
   <!-- –ü–µ—Ä—ñ–æ–¥ –≤—ñ–¥—Å—Ç–µ–∂–µ–Ω–Ω—è -->
    <section class="period-filter" data-aos="fade-up">
      <h3>
        <i class="fas fa-clock" aria-hidden="true"></i> –ü–µ—Ä—ñ–æ–¥ –≤—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É–≤–∞–Ω–Ω—è
      </h3>
      <div style="display: flex; gap: 1rem; align-items: center;">
        <select id="tracking-period" class="period-selector" aria-label="–í–∏–±–µ—Ä—ñ—Ç—å –ø–µ—Ä—ñ–æ–¥ –≤—ñ–¥—Å–ª—ñ–¥–∫–æ–≤—É–≤–∞–Ω–Ω—è">
          <option value="3">3 –¥–Ω—ñ</option>
          <option value="7">–¢–∏–∂–¥–µ–Ω—å</option>
          <option value="30">–ú—ñ—Å—è—Ü—å</option>
        </select>
        <button id="refresh-button" class="auth-btn" aria-label="–û–Ω–æ–≤–∏—Ç–∏ –¥–∞–Ω—ñ">
          <i class="fas fa-sync-alt" aria-hidden="true"></i> –û–Ω–æ–≤–∏—Ç–∏
        </button>
      </div>
    </section>
    
    <!-- –Ü–Ω–¥–∏–∫–∞—Ç–æ—Ä–∏ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ -->
    <section class="disaster-indicators" data-aos="fade-up">
      <div class="indicator-card earthquake">
        <div class="indicator-header">
          <div class="indicator-icon earthquake">
            <i class="fas fa-mountain" aria-hidden="true"></i>
          </div>
          <div>
            <h3>–°–µ–π—Å–º—ñ—á–Ω–∞ –∞–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</h3>
            <p class="metric-value">0.0 <span class="metric-unit">–±–∞–ª—ñ–≤</span></p>
          </div>
        </div>
        <div class="status-indicator status-normal">
          <div class="status-dot status-normal"></div>
          <span>–ê–Ω–∞–ª—ñ–∑...</span>
        </div>
      </div>
      <div class="indicator-card flood">
        <div class="indicator-header">
          <div class="indicator-icon flood">
            <i class="fas fa-water" aria-hidden="true"></i>
          </div>
          <div>
            <h3>–†—ñ–≤–µ–Ω—å –≤–æ–¥–∏</h3>
            <p class="metric-value">0.0 <span class="metric-unit">–º</span></p>
          </div>
        </div>
        <div class="status-indicator status-normal">
          <div class="status-dot status-normal"></div>
          <span>–ê–Ω–∞–ª—ñ–∑...</span>
        </div>
      </div>
      <div class="indicator-card volcano">
        <div class="indicator-header">
          <div class="indicator-icon volcano">
            <i class="fas fa-meteor" aria-hidden="true"></i>
          </div>
          <div>
            <h3>–í—É–ª–∫–∞–Ω–∏</h3>
            <p class="metric-value">0 <span class="metric-unit">–∞–∫—Ç–∏–≤–Ω–∏—Ö</span></p>
          </div>
        </div>
        <div class="status-indicator status-normal">
          <div class="status-dot status-normal"></div>
          <span>–ê–Ω–∞–ª—ñ–∑...</span>
        </div>
      </div>
      <div class="indicator-card wildfire">
        <div class="indicator-header">
          <div class="indicator-icon wildfire">
            <i class="fas fa-fire" aria-hidden="true"></i>
          </div>
          <div>
            <h3>–ü–æ–∂–µ–∂—ñ</h3>
            <p class="metric-value">0 <span class="metric-unit">–æ—á–∞–≥—ñ–≤</span></p>
          </div>
        </div>
        <div class="status-indicator status-normal">
          <div class="status-dot status-normal"></div>
          <span>–ê–Ω–∞–ª—ñ–∑...</span>
        </div>
      </div>
    </section>
    
    <!-- –ú–∞–ø–∞ -->
    <section class="map-container" id="disasterMap" aria-label="–ö–∞—Ä—Ç–∞ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ" data-aos="fade-in"></section>
    
<!-- –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø–æ–¥—ñ—ó -->
<section class="critical-events" data-aos="fade-up">
    <div class="container">
      <h2>
        <i class="fas fa-exclamation-triangle" aria-hidden="true"></i> –ö—Ä–∏—Ç–∏—á–Ω—ñ –ø–æ–¥—ñ—ó
      </h2>
      <div id="critical-events-list" class="critical-events-container">
        <!-- –ü—Ä–∏–º–µ—Ä –∫–∞—Ä—Ç–æ—á–∫–∏ —Å–æ–±—ã—Ç–∏—è -->
        <!-- –ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–±—ã—Ç–∏—è, –∫–∞—Ä—Ç–æ—á–∫–∏ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –∞ –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç ‚Äì –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç-–∑–∞–≥–ª—É—à–∫—É -->
        <div class="critical-event-card">
           <i class="fas fa-exclamation-circle critical-event-icon" aria-hidden="true"></i>
           <div class="critical-event-title">–ù–æ–≤–∞ –ø–æ–¥—ñ—è</div>
           <div class="critical-event-description">–î–µ—Ç–∞–ª—ñ –ø–æ–¥—ñ—ó...</div>
        </div>
    
        <p class="no-events">–ù–∞—Ä–∞–∑—ñ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø–æ–¥—ñ–π –Ω–µ–º–∞—î</p>
      </div>
    </div>
  </section>
  
  <style>
        /* –ó–∞–≥–∞–ª—å–Ω—ñ —Å—Ç–∏–ª—ñ –¥–ª—è —Å–µ–∫—Ü—ñ—ó –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø–æ–¥—ñ–π */
.critical-events {
  padding: 2rem 0;
}

/* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –∫–∞—Ä—Ç–æ–∫ - —Ä–æ–∑—Ç–∞—à–æ–≤—É—î–º–æ –∫–∞—Ä—Ç–∫–∏ –≤ —Ä—è–¥ —ñ–∑ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–Ω—è–º */
.critical-events-container {
  display: flex;
  flex-wrap: wrap;
  gap: 1.5rem;
  justify-content: center;
  align-items: stretch;
}

/* –Ø–∫—â–æ –ø–æ–¥—ñ–π –Ω–µ–º–∞—î, —Ü–µ–Ω—Ç—Ä—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è */
.critical-events-container .no-events {
  flex-basis: 100%;
  text-align: center;
  font-size: 1rem;
  color: #666;
  padding: 1rem;
}

/* –ö–∞—Ä—Ç–∫–∞ –ø–æ–¥—ñ—ó */
.critical-event-card {
  background: var(--card-bg-light);
  border-radius: var(--border-radius);
  padding: 1rem;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  min-width: 200px;
  flex: 1 1 250px; 
  max-width: 300px;
  transition: transform 0.3s, box-shadow 0.3s;
}

/* –¢–µ–º–Ω–∞ —Ç–µ–º–∞ */
body.dark .critical-event-card {
  background: var(--card-bg-dark);
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

/* Hover-–µ—Ñ–µ–∫—Ç –¥–ª—è –∫–∞—Ä—Ç–∫–∏ */
.critical-event-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 12px 24px rgba(0,0,0,0.2);
}

.critical-event-icon {
  font-size: 2rem;
  color: var(--danger-color);
  margin-bottom: 0.5rem;
}

.critical-event-title {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 0.5rem;
  text-align: center;
}

.critical-event-description {
  font-size: 0.9rem;
  text-align: center;
  color: #666;
}

body.dark .critical-event-description {
  color: #ccc;
}

  </style>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ -->
    <section class="stats-section" data-aos="fade-up">
      <div class="stats-header">
        <h2>
          <i class="fas fa-chart-bar" aria-hidden="true"></i> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ
        </h2>
        <select class="period-selector" id="period-select" aria-label="–û–±–µ—Ä—ñ—Ç—å –ø–µ—Ä—ñ–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏">
          <option value="day">–î–æ–±–æ–≤–∞</option>
          <option value="week">–¢–∏–∂–Ω–µ–≤–∞</option>
          <option value="month">–ú—ñ—Å—è—á–Ω–∞</option>
        </select>
      </div>
      <div class="stats-chart-container">
        <canvas id="statsChart" aria-label="–ì—Ä–∞—Ñ—ñ–∫ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"></canvas>
      </div>
    </section>
    
   <!-- –°—Ç—Ä—ñ—á–∫–∞ –ø–æ–¥—ñ–π -->
    <section class="disaster-timeline" aria-label="–õ–µ–Ω—Ç–∞ –ø–æ–¥—ñ–π" data-aos="fade-up">
      <div class="timeline-event alert-pulse">
        <div class="notification-badge" aria-label="–ù–æ–≤–∏–π —Å–∏–≥–Ω–∞–ª">!</div>
        <h4>–°–∏—Å—Ç–µ–º–∞ –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–∞</h4>
        <p>–û—Å—Ç–∞–Ω–Ω—î –æ–Ω–æ–≤–ª–µ–Ω–Ω—è: <span id="live-time"></span></p>
      </div>
    </section>
    
    <!-- –î–æ–¥–∞—Ç–∫–æ–≤–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è: —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–µ—Ä–µ–∂—É -->
    <section class="additional-info" data-aos="fade-up">
      <div class="ip-geolocation">
        <h2>üåç –Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –º–µ—Ä–µ–∂—É</h2>
        <div id="network-info">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>
      </div>
    </section>
  </main>
  
  <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è -->
  <div id="update-notification" role="alert">
    <i class="fas fa-sync-alt fa-spin" aria-hidden="true"></i> –î–∞–Ω—ñ –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è, –∑–∞—á–µ–∫–∞–π—Ç–µ...
  </div>

  <div class="theme-toggle" id="theme-toggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–∏ —Ç–µ–º—É">
    <i class="fas fa-adjust"></i>
  </div>
  
  <!-- –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è -->
  <div class="settings-toggle" id="settings-toggle" aria-label="–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è">
    <i class="fas fa-cog"></i>
  </div>
  
  <div id="settings-section" class="settings-section" aria-modal="true">
    <h2>
      <i class="fas fa-cog" aria-hidden="true"></i> –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
    </h2>
    <form id="settings-form">
      <div class="form-group">
        <label for="seismic-threshold">–ü–æ—Ä—ñ–≥ —Å–µ–π—Å–º—ñ—á–Ω–æ—ó –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ</label>
        <input type="number" id="seismic-threshold" value="4.0" step="0.1" required>
      </div>
      <div class="form-group">
        <label for="water-threshold">–ü–æ—Ä—ñ–≥ —Ä—ñ–≤–Ω—è –≤–æ–¥–∏</label>
        <input type="number" id="water-threshold" value="3.5" step="0.1" required>
      </div>
      <div class="form-group">
        <label for="language-select">–ú–æ–≤–∞</label>
        <select id="language-select">
          <option value="uk">–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞</option>
          <option value="en">English</option>
        </select>
      </div>
      <div class="form-group">
        <label for="notifications-toggle">–û—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è</label>
        <input type="checkbox" id="notifications-toggle" checked>
      </div>
      <button type="submit">
        <i class="fas fa-save"></i> –ó–±–µ—Ä–µ–≥—Ç–∏
      </button>
    </form>
  </div>
  
  <!-- Scripts -->
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è AOS –¥–ª—è –ø–ª–∞–≤–Ω–æ—ó –ø–æ—è–≤–∏ –µ–ª–µ–º–µ–Ω—Ç—ñ–≤
    AOS.init({
      duration: 800,
      easing: 'ease-in-out',
      once: true
    });
    
    // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è –≤–∏–¥–∏–º–æ—Å—Ç—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å
    document.getElementById('settings-toggle').addEventListener('click', function() {
      const settingsSection = document.getElementById('settings-section');
      settingsSection.style.display = (settingsSection.style.display === 'block') ? 'none' : 'block';
    });
    
   // –ü–µ—Ä–µ–º–∏–∫–∞—á —Ç–µ–º–∏ (—Å–≤—ñ—Ç–ª–∞/—Ç–µ–º–Ω–∞)
    document.getElementById('theme-toggle').addEventListener('click', function() {
      document.body.classList.toggle('dark');
    });
    
     // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —á–∞—Å—É –≤ —Ä–µ–∂–∏–º—ñ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É
    function updateLiveTime() {
      document.getElementById('live-time').textContent = new Date().toLocaleTimeString();
    }
    setInterval(updateLiveTime, 1000);
    
    // –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö
    function showUpdateNotification() {
      const notif = document.getElementById('update-notification');
      notif.style.display = 'flex';
      setTimeout(() => { notif.style.display = 'none'; }, 3000);
    }
    
    document.getElementById('refresh-button').addEventListener('click', function() {
      showUpdateNotification();

    });
    
    function getIP(json) {
      const networkInfo = document.getElementById('network-info');
      networkInfo.innerHTML = `<p>–í–∞—à IP: ${json.ip}</p>`;
    }
  </script>
</body>
</html>


<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    // –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è API
    const CONFIG = {
        OPENWEATHER_API_KEY: 'bd5e378503939ddaee76f12ad7a97608',
        EONET_API_URL: 'https://eonet.gsfc.nasa.gov/api/v3',
        USGS_API_URL: 'https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary'
    };

      // –°—Ç–∞–Ω –ø—Ä–æ–≥—Ä–∞–º–∏
    const state = {
        activeFilters: new Set(['earthquake', 'flood', 'volcano', 'wildfire']),
        currentData: {},
        markers: [],
        thresholds: {
            seismic: 4.0,
            water: 3.5
        },
        trackingPeriod: 3 // –ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤ –¥–ª—è —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó –ø–æ–¥—ñ–π (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, 3, 7, 30)
    };

       // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –∫–∞—Ä—Ç–∏
    const map = L.map('disasterMap').setView([30, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è –≥—Ä–∞—Ñ—ñ–∫–∞ Chart.js
    const statsCtx = document.getElementById('statsChart').getContext('2d');
    let statsChart = new Chart(statsCtx, {
        type: 'bar',
        data: {
            labels: [],
            datasets: [{
                label: '–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–¥—ñ–π',
                data: [],
                backgroundColor: '#2563eb',
                borderColor: '#1e40af',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: { 
                y: { beginAtZero: true } 
            },
            plugins: {
                legend: {
                    display: true,
                    position: 'top'
                },
                title: {
                    display: true,
                    text: '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥—ñ–π'
                }
            }
        }
    });

    // –î–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è: –ø–æ–≤–µ—Ä—Ç–∞—î –¥–∞—Ç—É –±–µ–∑ —á–∞—Å—É (–ø–æ—á–∞—Ç–æ–∫ –¥–Ω—è)
    function getStartOfDay(date) {
        const newDate = new Date(date);
        newDate.setHours(0, 0, 0, 0);
        return newDate;
    }

      // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –ø—Ä–æ –∑–µ–º–ª–µ—Ç—Ä—É—Å–∏
    async function getEarthquakeData() {
        try {
            const response = await fetch(`${CONFIG.USGS_API_URL}/4.5_${getUSGSTimeRange()}.geojson`);
            const data = await response.json();
            const periodStart = Date.now() - (state.trackingPeriod * 24 * 60 * 60 * 1000);
            
            return data.features
                .map(quake => ({
                    type: 'earthquake',
                    magnitude: quake.properties.mag,
                    location: {
                        lat: quake.geometry.coordinates[1],
                        lng: quake.geometry.coordinates[0]
                    },
                    title: quake.properties.place,
                    time: new Date(quake.properties.time)
                }))
                .filter(quake => quake.time.getTime() >= periodStart && quake.time.getTime() <= Date.now());
        } catch (error) {
            console.error('Error fetching earthquake data:', error);
            return [];
        }
    }

    // –í–∏–∑–Ω–∞—á–∞—î–º–æ —á–∞—Å–æ–≤–∏–π —ñ–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è USGS API (—Ç–∏–∂–¥–µ–Ω—å –∞–±–æ –º—ñ—Å—è—Ü—å)
    function getUSGSTimeRange() {
        if (state.trackingPeriod <= 7) return 'week';
        if (state.trackingPeriod <= 30) return 'month';
        return 'month';
    }

// –û—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö –∑ EONET API
    async function getEONETEvents() {
        try {
            const response = await fetch(`${CONFIG.EONET_API_URL}/events`);
            const data = await response.json();
            const periodStart = Date.now() - (state.trackingPeriod * 24 * 60 * 60 * 1000);

            return data.events
                .map(event => {
                    const geometry = event.geometry[event.geometry.length - 1];
                    return {
                        type: getEventType(event.categories[0].id),
                        title: event.title,
                        location: {
                            lat: geometry.coordinates[1],
                            lng: geometry.coordinates[0]
                        },
                        time: new Date(geometry.date)
                    };
                })
                .filter(event => event.time.getTime() >= periodStart && event.time.getTime() <= Date.now());
        } catch (error) {
            console.error('Error fetching EONET data:', error);
            return [];
        }
    }

    // –ü–µ—Ä–µ—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ç–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –≤ —Ç–∏–ø –ø–æ–¥—ñ—ó
    function getEventType(categoryId) {
        const typeMap = {
            'volcanoes': 'volcano',
            'wildfires': 'wildfire',
            'severeStorms': 'flood'
        };
        return typeMap[categoryId] || 'other';
    }

     // –û—Å–Ω–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è UI
    async function updateUI() {
        try {
            const earthquakes = await getEarthquakeData();
            const eonetEvents = await getEONETEvents();
            const allEvents = [...earthquakes, ...eonetEvents];
            state.currentData.events = allEvents;

            updateIndicators(allEvents);
            updateMapMarkers(allEvents);
            updateCriticalEvents(allEvents);

            const now = new Date();
            document.getElementById('live-time').textContent = now.toLocaleTimeString();
            document.getElementById('last-updated').innerHTML = `
                <i class="fas fa-sync-alt"></i> –û–Ω–æ–≤–ª–µ–Ω–æ: ${now.toLocaleTimeString()}
            `;

            updateStatistics(allEvents);
        } catch (error) {
            console.error('Error updating UI:', error);
        }
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —ñ–Ω–¥–∏–∫–∞—Ç–æ—Ä—ñ–≤ (–∫–∞—Ä—Ç–æ–∫)
    function updateIndicators(events) {
        const stats = {
            earthquake: { count: 0, maxMagnitude: 0 },
            volcano: { count: 0 },
            wildfire: { count: 0 },
            flood: { count: 0 }
        };

        const periodStart = Date.now() - (state.trackingPeriod * 24 * 60 * 60 * 1000);

        events.forEach(event => {
            const eventTime = event.time.getTime();
            if (eventTime >= periodStart && eventTime <= Date.now() && state.activeFilters.has(event.type)) {
                if (stats[event.type] !== undefined) {
                    stats[event.type].count++;
                    if (event.type === 'earthquake' && event.magnitude > stats.earthquake.maxMagnitude) {
                        stats.earthquake.maxMagnitude = event.magnitude;
                    }
                }
            }
        });

        document.querySelectorAll('.indicator-card').forEach(card => {
            const type = card.classList[1]; 
            const valueElem = card.querySelector('.metric-value');
            const statusIndicator = card.querySelector('.status-indicator');
            
            if (type === 'earthquake') {
                const magnitude = stats.earthquake.maxMagnitude || 0;
                valueElem.textContent = `${magnitude.toFixed(1)} –±–∞–ª—ñ–≤`;
                if (magnitude > state.thresholds.seismic) {
                    card.classList.add('critical', 'alert-pulse');
                    statusIndicator.querySelector('span').textContent = '–ù–µ–±–µ–∑–ø–µ–∫–∞!';
                } else {
                    card.classList.remove('critical', 'alert-pulse');
                    statusIndicator.querySelector('span').textContent = stats.earthquake.count > 0 ? `–ê–∫—Ç–∏–≤–Ω–∏—Ö: ${stats.earthquake.count}` : '–ù–æ—Ä–º–∞';
                }
            } else {
                const count = stats[type].count;
                valueElem.textContent = `${count} –∞–∫—Ç–∏–≤–Ω–∏—Ö`;
                statusIndicator.querySelector('span').textContent = count > 0 ? `–ê–∫—Ç–∏–≤–Ω–∏—Ö: ${count}` : '–ù–æ—Ä–º–∞';
            }
        });
    }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –º–∞—Ä–∫–µ—Ä—ñ–≤ –Ω–∞ –∫–∞—Ä—Ç—ñ
    function updateMapMarkers(events) {

        state.markers.forEach(marker => {
            marker.setOpacity(0);
            setTimeout(() => map.removeLayer(marker), 300);
        });
        state.markers = [];

        const periodStart = Date.now() - (state.trackingPeriod * 24 * 60 * 60 * 1000);

        events
            .filter(event => {
                const eventTime = event.time.getTime();
                return (
                    eventTime >= periodStart &&
                    eventTime <= Date.now() &&
                    state.activeFilters.has(event.type)
                );
            })
            .forEach(event => {
                const marker = L.marker([event.location.lat, event.location.lng], {
                    opacity: 0,
                    riseOnHover: true
                })
                .addTo(map)
                .bindPopup(createPopupContent(event));
                
                // –ü–ª–∞–≤–Ω–∞ –ø–æ—è–≤–∞ –º–∞—Ä–∫–µ—Ä–∞
                setTimeout(() => marker.setOpacity(1), 300);
                state.markers.push(marker);
            });
    }

    // –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É —Å–ø–ª–∏–≤–∞—é—á–æ–≥–æ –≤—ñ–∫–Ω–∞ –¥–ª—è –º–∞—Ä–∫–µ—Ä–∞
    function createPopupContent(event) {
        let content = `<b>${event.title}</b><br>`;
        if (event.type === 'earthquake') {
            content += `–ú–∞–≥–Ω—ñ—Ç—É–¥–∞: ${event.magnitude}<br>`;
        }
        content += `–î–∞—Ç–∞: ${event.time.toLocaleDateString('uk-UA', { year: 'numeric', month: 'long', day: 'numeric' })}<br>`;
        content += `–ß–∞—Å: ${event.time.toLocaleTimeString('uk-UA')}`;
        return content;
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ –≥—Ä–∞—Ñ—ñ–∫—É Chart.js –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –æ–±—Ä–∞–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó
    function updateStatistics(events) {
        // –†–µ–∂–∏–º –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó –≤–∏–±–∏—Ä–∞—î—Ç—å—Å—è —ñ–∑ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞ –∑ id ¬´period-select¬ª
        // –ú–æ–∂–ª–∏–≤—ñ –∑–Ω–∞—á–µ–Ω–Ω—è: ¬´day¬ª (–¥–æ–±–æ–≤–∞), ¬´week¬ª (—Ç–∏–∂–Ω–µ–≤–∞), ¬´month¬ª (–º—ñ—Å—è—á–Ω–∞)
        const mode = document.getElementById('period-select').value;
        const eventTypes = ['earthquake', 'flood', 'volcano', 'wildfire'];
        let labels = [];
        let datasetsByType = {};
        eventTypes.forEach(type => {
            datasetsByType[type] = [];
        });

        if (mode === "day") {
            // –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –∑–∞ –¥–Ω—è–º–∏
            const periodDays = state.trackingPeriod;
            const startDate = getStartOfDay(new Date());
            startDate.setDate(startDate.getDate() - periodDays + 1);
            for (let d = 0; d < periodDays; d++) {
                const currentDay = new Date(startDate);
                currentDay.setDate(currentDay.getDate() + d);
                labels.push(currentDay.toLocaleDateString('uk-UA', { day: 'numeric', month: 'short' }));
                eventTypes.forEach(type => {
                    const count = events.filter(event => {
                        if (event.type !== type) return false;
                        const eventDay = getStartOfDay(new Date(event.time));
                        return eventDay.getTime() === currentDay.getTime();
                    }).length;
                    datasetsByType[type].push(count);
                });
            }
        } else if (mode === "week") {
            // –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –ø–æ —Ç–∏–∂–Ω—è—Ö
            const periodDays = state.trackingPeriod;
            const weeks = Math.ceil(periodDays / 7);
            const startDate = getStartOfDay(new Date());
            startDate.setDate(startDate.getDate() - periodDays + 1);
            for (let w = 0; w < weeks; w++) {
                const weekStart = new Date(startDate);
                weekStart.setDate(weekStart.getDate() + w * 7);
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekEnd.getDate() + 7);
                labels.push(`–¢–∏–∂–¥–µ–Ω—å ${w + 1}`);
                eventTypes.forEach(type => {
                    const count = events.filter(event => {
                        if (event.type !== type) return false;
                        const eventTime = new Date(event.time);
                        return eventTime >= weekStart && eventTime < weekEnd;
                    }).length;
                    datasetsByType[type].push(count);
                });
            }
        } else if (mode === "month") {
            // –ì—Ä—É–ø—É–≤–∞–Ω–Ω—è –∑–∞ –º—ñ—Å—è—Ü—è–º–∏: –≥—Ä—É–ø—É—î–º–æ –∑–∞ —Ä–æ–∫–æ–º-–º—ñ—Å—è—Ü–µ–º
            let groups = {}; // –∫–ª—é—á: ¬´YYYY-MM¬ª, –∑–Ω–∞—á–µ–Ω–Ω—è: –æ–±'—î–∫—Ç —ñ–∑ –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫–∞–º–∏ –∑–∞ —Ç–∏–ø–∞–º–∏
            events.forEach(event => {
                if (!eventTypes.includes(event.type)) return;
                const date = new Date(event.time);
                const key = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, '0')}`;
                if (!groups[key]) {
                    groups[key] = {};
                    eventTypes.forEach(type => groups[key][type] = 0);
                }
                groups[key][event.type]++;
            });
            labels = Object.keys(groups).sort();
            labels.forEach(key => {
                eventTypes.forEach(type => {
                    datasetsByType[type].push(groups[key][type] || 0);
                });
            });
        }

        // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –≥—Ä–∞—Ñ—ñ–∫–∞ Chart.js
        statsChart.data.labels = labels;
        statsChart.data.datasets = eventTypes.map(type => ({
            label: type.charAt(0).toUpperCase() + type.slice(1),
            data: datasetsByType[type],
            backgroundColor: getColorForEventType(type),
            borderColor: getColorForEventType(type).replace('0.6', '1'),
            borderWidth: 1
        }));
        statsChart.options.plugins.title = {
            display: true,
            text: `–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–¥—ñ–π (${mode === "day" ? "–î–æ–±–æ–≤–∞" : mode === "week" ? "–¢–∏–∂–Ω–µ–≤–∞" : "–ú—ñ—Å—è—á–Ω–∞"})`
        };
        statsChart.update();
    }

    // –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–æ–ª—å–æ—Ä—É –¥–ª—è —Ç–∏–ø—É –ø–æ–¥—ñ—ó
    function getColorForEventType(type) {
        const colorMap = {
            'earthquake': 'rgba(220, 38, 38, 0.6)',   // –ß–µ—Ä–≤–æ–Ω–∏–π
            'flood': 'rgba(37, 99, 235, 0.6)',         // –°–∏–Ω—ñ–π
            'volcano': 'rgba(245, 158, 11, 0.6)',       // –ñ–æ–≤—Ç–∏–π
            'wildfire': 'rgba(249, 115, 22, 0.6)'       // –ü–æ–º–∞—Ä–∞–Ω—á–µ–≤–∏–π
        };
        return colorMap[type] || 'rgba(0,0,0,0.6)';
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö (–Ω–∞–π–±—ñ–ª—å—à –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö) –ø–æ–¥—ñ–π
    function updateCriticalEvents(events) {
        const container = document.getElementById('critical-events-list');
        container.innerHTML = '';

        // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏—Ö –ø–æ–¥—ñ–π:
        // - –ó–µ–º–ª–µ—Ç—Ä—É—Å–∏ –∑ –º–∞–≥–Ω—ñ—Ç—É–¥–æ—é –≤–∏—â–µ –∑–∞ –ø–æ—Ä—ñ–≥
        // - –£—Å—ñ –≤—É–ª–∫–∞–Ω—ñ—á–Ω—ñ —Ç–∞ –ø–æ–∂–µ–∂–Ω—ñ –ø–æ–¥—ñ—ó –≤–≤–∞–∂–∞—é—Ç—å—Å—è –Ω–µ–±–µ–∑–ø–µ—á–Ω–∏–º–∏
        const dangerousEvents = events.filter(event => {
            if (event.type === 'earthquake') {
                return event.magnitude > state.thresholds.seismic;
            }
            if (event.type === 'volcano' || event.type === 'wildfire') {
                return true;
            }
            return false;
        });

        if (dangerousEvents.length === 0) {
            container.innerHTML = '<p class="no-events">–ù–∞—Ä–∞–∑—ñ –∫—Ä–∏—Ç–∏—á–Ω–∏—Ö –ø–æ–¥—ñ–π –Ω–µ–º–∞—î</p>';
            return;
        }

        // –°–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π –≤—ñ–¥ –Ω–æ–≤–∏—Ö –¥–æ —Å—Ç–∞—Ä–∏—Ö
        dangerousEvents.sort((a, b) => b.time - a.time);

        dangerousEvents.forEach(event => {
            // –°—Ç–≤–æ—Ä—é—î–º–æ –æ–∫—Ä–µ–º–∏–π –±–ª–æ–∫ –¥–ª—è –ø–æ–¥—ñ—ó
            const eventElem = document.createElement('div');
            eventElem.className = 'critical-event-card';
            
            // –í–∏–±—ñ—Ä –∑–Ω–∞—á–∫–∞ —ñ –π–æ–≥–æ –∫–æ–ª—ñ—Ä –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ —Ç–∏–ø—É –ø–æ–¥—ñ—ó
            let iconHtml = '';
            if (event.type === 'earthquake') {
                iconHtml = '<i class="fas fa-exclamation-triangle" style="color: #dc2626;"></i>';
            } else if (event.type === 'volcano') {
                iconHtml = '<i class="fas fa-exclamation-triangle" style="color: #eab308;"></i>';
            } else if (event.type === 'wildfire') {
                iconHtml = '<i class="fas fa-exclamation-triangle" style="color: #f97316;"></i>';
            } else {
                iconHtml = '<i class="fas fa-exclamation-circle" style="color: #374151;"></i>';
            }
            
            // –§–æ—Ä–º—É–≤–∞–Ω–Ω—è –≤–º—ñ—Å—Ç—É –±–ª–æ–∫—É
            let info = `<div class="critical-event-icon">${iconHtml}</div>`;
            info += `<div class="critical-event-info">`;
            info += `<h4>${event.title}</h4>`;
            info += `<p>–¢–∏–ø: ${event.type.charAt(0).toUpperCase() + event.type.slice(1)}</p>`;
            info += `<p>–î–∞—Ç–∞: ${event.time.toLocaleDateString('uk-UA')} ${event.time.toLocaleTimeString('uk-UA')}</p>`;
            if (event.type === 'earthquake') {
                info += `<p>–ú–∞–≥–Ω—ñ—Ç—É–¥–∞: ${event.magnitude}</p>`;
            }
            info += `</div>`;
            
            eventElem.innerHTML = info;
            container.appendChild(eventElem);
        });
    }

    // –û—Ç—Ä–∏–º–∞–Ω–Ω—è IP —Ç–∞ –≥–µ–æ–ª–æ–∫–∞—Ü—ñ–π–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó
    async function getIPData() {
        try {
            const response = await fetch('https://ipapi.co/json/');
            const data = await response.json();
            if (data.error) {
                document.getElementById('network-info').innerHTML = `<p>–ü–æ–º–∏–ª–∫–∞: ${data.error}</p>`;
            } else {
                const userLocation = { lat: data.latitude, lng: data.longitude };
                const nearestEvent = findNearestEvent(userLocation);
                document.getElementById('network-info').innerHTML = `
                    <p>IP: ${data.ip}</p>
                    <p>–ú—ñ—Å—Ç–æ: ${data.city}</p>
                    <p>–ö—Ä–∞—ó–Ω–∞: ${data.country_name}</p>
                    <p>–ü—Ä–æ–≤–∞–π–¥–µ—Ä: ${data.org}</p>
                    <p>–ù–∞–π–±–ª–∏–∂—á–∞ –ø–æ–¥—ñ—è: ${nearestEvent ? nearestEvent.title : '–ù–µ–º–∞—î'}</p>
                    <p>–í—ñ–¥—Å—Ç–∞–Ω—å: ${nearestEvent ? calculateDistance(userLocation, nearestEvent.location) + ' –∫–º' : '–ù–µ–º–∞—î'}</p>
                `;
            }
        } catch (error) {
            document.getElementById('network-info').innerHTML = '<p>–ü–æ–º–∏–ª–∫–∞: –Ω–µ –≤–¥–∞–ª–æ—Å—è –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–∞–Ω—ñ</p>';
        }
    }

    // –ü–æ—à—É–∫ –Ω–∞–π–±–ª–∏–∂—á–æ—ó –ø–æ–¥—ñ—ó –¥–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
    function findNearestEvent(userLocation) {
        const events = state.currentData.events || [];
        let nearestEvent = null;
        let minDistance = Infinity;
        events.forEach(event => {
            const distance = calculateDistance(userLocation, event.location);
            if (distance < minDistance) {
                minDistance = distance;
                nearestEvent = event;
            }
        });
        return nearestEvent;
    }

    // –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –≤—ñ–¥—Å—Ç–∞–Ω—ñ –º—ñ–∂ –¥–≤–æ–º–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (—É –∫–º)
    function calculateDistance(loc1, loc2) {
        const R = 6371;
        const dLat = (loc2.lat - loc1.lat) * (Math.PI / 180);
        const dLng = (loc2.lng - loc1.lng) * (Math.PI / 180);
        const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                  Math.cos(loc1.lat * (Math.PI / 180)) * Math.cos(loc2.lat * (Math.PI / 180)) *
                  Math.sin(dLng / 2) * Math.sin(dLng / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        return Math.round(R * c);
    }

    // –û–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π –¥–ª—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ UI
    document.getElementById('tracking-period').addEventListener('change', function() {
        state.trackingPeriod = parseInt(this.value);
        updateUI();
    });

    document.querySelectorAll('.filter-card').forEach(card => {
        card.addEventListener('click', function() {
            const type = this.dataset.type;
            this.classList.toggle('active');
            if (state.activeFilters.has(type)) {
                state.activeFilters.delete(type);
            } else {
                state.activeFilters.add(type);
            }
            updateUI();
        });
    });

    // –ü—Ä–∏ –∑–º—ñ–Ω—ñ —Ä–µ–∂–∏–º—É –∞–≥—Ä–µ–≥–∞—Ü—ñ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (–¥–æ–±–æ–≤–∞, —Ç–∏–∂–Ω–µ–≤–∞, –º—ñ—Å—è—á–Ω–∞) –æ–Ω–æ–≤–ª—é—î–º–æ –≥—Ä–∞—Ñ—ñ–∫
    document.getElementById('period-select').addEventListener('change', updateUI);

    document.getElementById('settings-form').addEventListener('submit', (e) => {
        e.preventDefault();
        state.thresholds.seismic = parseFloat(document.getElementById('seismic-threshold').value);
        state.thresholds.water = parseFloat(document.getElementById('water-threshold').value);
        localStorage.setItem('settings', JSON.stringify(state.thresholds));
        updateUI();
    });

    document.getElementById('refresh-button').addEventListener('click', async function() {
        const notification = document.getElementById('update-notification');
        let timeoutId;
        try {
            notification.style.display = 'flex';
            await updateUI();
            timeoutId = setTimeout(() => {
                notification.style.display = 'none';
            }, 500);
        } catch (error) {
            console.error('–ü–æ–º–∏–ª–∫–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:', error);
            notification.style.display = 'none';
            clearTimeout(timeoutId);
        }
    });

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–±–µ—Ä–µ–∂–µ–Ω–∏—Ö –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å –∑ localStorage
    const savedSettings = localStorage.getItem('settings');
    if (savedSettings) {
        state.thresholds = JSON.parse(savedSettings);
        document.getElementById('seismic-threshold').value = state.thresholds.seismic;
        document.getElementById('water-threshold').value = state.thresholds.water;
    }

    // –ü–µ—Ä–≤—ñ—Å–Ω–∞ —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
    getIPData();
    updateUI();

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö –∫–æ–∂–Ω—ñ 5 —Ö–≤–∏–ª–∏–Ω
    setInterval(updateUI, 300000);
});
</script>
